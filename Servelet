<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Student DB Operations</title>
</head>
<body>

<h2>Insert Operation</h2>
<form action = "JavaWebServlet" method = "POST">
<input type = "hidden" name = "operation" value = "insert">
USN:<input type = "text" name = "usn" required>
Name:<input type = "text" name = "name" required>
Gender:<input type = "text" name = "gender" required>
Age:<input type = "text" name = "age" required>
<input type = "submit" value = "Insert">
</form>

<br>

<h2>Delete Operation</h2>
<form action = "JavaWebServlet" method = "POST">
<input type = "hidden" name = "operation" value = "delete">
USN:<input type = "text" name = "usn" required>
<input type = "submit" value = "Delete">
</form>

<br>

<h2>Update Operation</h2>
<form action = "JavaWebServlet" method = "POST">
<input type = "hidden" name = "operation" value = "update">
USN:<input type = "text" name = "usn" required>
Name:<input type = "text" name = "name" required>
<input type = "submit" value = "Update">
</form>

<br>

<h2>Extract Operation</h2>
<form action = "JavaWebServlet" method = "POST">
<input type = "hidden" name = "operation" value = "extract">
USN:<input type = "text" name = "usn" required>
<input type = "submit" value = "Extract">
</form>

<br>


</body>
</html>











import java.io.PrintWriter;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Servlet implementation class JavaWebServlet
 */
@WebServlet("/JavaWebServlet")
public class JavaWebServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;
	
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		response.setContentType("text/html");
		PrintWriter out = response.getWriter();
		String operation = request.getParameter("operation");
		String usn = request.getParameter("usn");
		
		
		String jdbcUrl = "jdbc:mysql://localhost:3306/java";
		String rname = "root";
		String pass = "";
		
		try {
			Class.forName("com.mysql.jdbc.Driver");
			Connection connection = DriverManager.getConnection(jdbcUrl,rname,pass);
			
			switch(operation) {
				
			case "insert":
				String sqlQuery1 = "INSERT INTO stud(name,usn,gender,age) values (?,?,?,?)";
				PreparedStatement ps = connection.prepareStatement(sqlQuery1);  
				ps.setString(1,usn);
				ps.setString(2,request.getParameter("name"));
				ps.setString(3,request.getParameter("gender"));
				ps.setString(4,request.getParameter("age"));
				ps.executeUpdate();
				out.println("<h2>Inserted Successfully</h2>");
				ps.close();
			break;
			
			case "delete":
				String sqlQuery2 = "DELETE from stud where usn = ?";
				PreparedStatement ps2 = connection.prepareStatement(sqlQuery2);  
				ps2.setString(1,usn);
				if(ps2.executeUpdate() > 0)
				out.println("<h2>Deleted Successfully</h2>");
				else
					out.println("<h2>Not Deleted</h2>");
				ps2.close();
			break;
			
			case "update":
				String sqlQuery3 = "UPDATE stud set name = ? where usn = ?";
				PreparedStatement ps3 = connection.prepareStatement(sqlQuery3);  
				ps3.setString(1,request.getParameter("name"));
				ps3.setString(2,usn);
				if(ps3.executeUpdate() > 0)
				out.println("<h2>Updated Successfully</h2>");
				else
					out.println("<h2>Not Updated</h2>");
				ps3.close();
			break;
			
			case "extract":
				String sqlQuery4 = "SELECT * from stud where usn = ?";
				PreparedStatement ps4 = connection.prepareStatement(sqlQuery4);
				ps4.setString(1,usn);
				ResultSet rs = ps4.executeQuery();
				if(rs.next())
				{
					out.println("<p><strong>USN:</strong>"+rs.getString("usn")+"</p>");
					out.println("<p><strong>Name:</strong>"+rs.getString("name")+"</p>");
					out.println("<p><strong>Gender:</strong>"+rs.getString("gender")+"</p>");
					out.println("<p><strong>Age:</strong>"+rs.getString("age")+"</p>");
				}
				else
					out.println("<h2 style = 'color : red'>Not possible to extract</h2>");
				ps4.close();
				rs.close();
			break;
			
			default :
				out.println("</h2>Not possible , Invalid Query</h2>");
			}
			connection.close();
			out.close();	
		}catch(Exception e)
		{
			e.printStackTrace();
		}
		
	}

}

